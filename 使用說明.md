# WealthManager APK 安裝和日誌記錄腳本

## 📁 檔案清單

### Python 版本（需要 Python 3.6+）
- `wealthmanager_logger.py` - 主要腳本
- `apk_installer_logger.py` - 通用版本
- `test_logger.py` - 測試腳本
- `run_wealthmanager_logger.bat` - 執行批次檔

### PowerShell 版本（Windows 內建）
- `wealthmanager_logger.ps1` - PowerShell 腳本
- `run_wealthmanager_logger_powershell.bat` - 執行批次檔

## 🚀 快速開始

### 方法一：使用 PowerShell 版本（推薦）
```bash
# 雙擊執行
run_wealthmanager_logger_powershell.bat
```

### 方法二：使用 Python 版本
```bash
# 雙擊執行
run_wealthmanager_logger.bat
```

### 方法三：手動執行
```bash
# PowerShell 版本
powershell -ExecutionPolicy Bypass -File wealthmanager_logger.ps1

# Python 版本
python wealthmanager_logger.py WealthManager-v0.1.5-complete.apk
```

## 📋 前置條件

### 必要條件
1. **Android 設備** 已連接並啟用 USB 調試
2. **ADB 工具** 已安裝並設定環境變數
3. **WealthManager APK 檔案** 在專案目錄中

### 可選條件
- **Python 3.6+**（僅 Python 版本需要）
- **PowerShell 5.0+**（僅 PowerShell 版本需要，Windows 10 內建）

## 🔧 功能特點

### ✅ 自動化流程
1. 檢查 ADB 工具可用性
2. 檢查設備連接狀態
3. 卸載已存在的 WealthManager
4. 安裝指定的 APK 檔案
5. 啟動 WealthManager 應用程式
6. 開始記錄完整日誌
7. 監控應用程式狀態
8. 當應用程式關閉時自動停止記錄

### 📊 日誌記錄
- **記錄層級**：所有層級（VERBOSE, DEBUG, INFO, WARN, ERROR）
- **時間戳記**：包含精確時間
- **檔案格式**：`WealthManager_logs_YYYYMMDD_HHMMSS.txt`
- **保存位置**：專案根目錄

### 🔍 監控功能
- 每 5 秒檢查應用程式狀態
- **持續記錄直到手動終止（Ctrl+C）**
- 應用程式可以關閉並重新開啟，日誌記錄會持續進行
- 支援手動中斷（Ctrl+C）

## 📱 使用流程

1. **準備工作**
   - 確保 Android 設備已連接
   - 啟用 USB 調試
   - 授權電腦進行 USB 調試

2. **執行腳本**
   - 雙擊 `run_wealthmanager_logger_powershell.bat`
   - 或雙擊 `run_wealthmanager_logger.bat`

3. **監控過程**
   - 腳本會自動安裝 APK
   - 啟動 WealthManager 應用程式
   - 開始記錄日誌
   - 顯示監控狀態

4. **停止記錄**
   - 按 Ctrl+C 手動停止記錄
   - 應用程式可以關閉並重新開啟，日誌記錄會持續進行

## 📄 輸出檔案

### 日誌檔案
- **檔案名**：`WealthManager_logs_20240928_223000.txt`
- **位置**：專案根目錄
- **內容**：完整的應用程式運行日誌

## ⚠️ 故障排除

### 常見問題

1. **ADB 工具不可用**
   ```
   ❌ ADB 工具不可用
   ```
   **解決方案**：
   - 安裝 Android SDK Platform Tools
   - 設定環境變數 PATH

2. **設備未連接**
   ```
   ❌ 沒有檢測到連接的 Android 設備
   ```
   **解決方案**：
   - 檢查 USB 連接
   - 啟用 USB 調試
   - 授權電腦進行 USB 調試

3. **APK 安裝失敗**
   ```
   ❌ APK 安裝失敗
   ```
   **解決方案**：
   - 檢查 APK 檔案是否完整
   - 確保設備有足夠空間
   - 檢查設備是否允許安裝未知來源應用程式

4. **PowerShell 執行策略問題**
   ```
   PowerShell 執行策略限制
   ```
   **解決方案**：
   - 使用批次檔案執行（已設定 Bypass 策略）
   - 或手動設定執行策略

## 🔧 進階使用

### 自定義 APK 檔案
```bash
# PowerShell 版本
powershell -ExecutionPolicy Bypass -File wealthmanager_logger.ps1 -ApkPath "自定義.apk"

# Python 版本
python wealthmanager_logger.py 自定義.apk
```

### 查看即時日誌
```bash
# 查看所有日誌
adb logcat -v time *:V

# 只查看 WealthManager 日誌
adb logcat -v time com.wealthmanager:* *:S
```

### 手動控制
```bash
# 停止應用程式
adb shell am force-stop com.wealthmanager

# 清除日誌
adb logcat -c

# 重新啟動應用程式
adb shell am start -n com.wealthmanager/.MainActivity
```

## 📊 日誌分析

### 日誌層級說明
- **V (VERBOSE)**：最詳細的日誌，包含所有資訊
- **D (DEBUG)**：調試資訊，開發時使用
- **I (INFO)**：一般資訊，正常運行狀態
- **W (WARN)**：警告資訊，可能影響功能
- **E (ERROR)**：錯誤資訊，需要關注

### 重要日誌標記
- `WealthManagerDebug`：應用程式自定義日誌
- `AndroidRuntime`：系統運行時日誌
- `System.err`：系統錯誤日誌

## 🎯 最佳實踐

1. **定期清理日誌**：長時間運行會產生大量日誌
2. **監控磁碟空間**：確保有足夠空間存儲日誌
3. **保護隱私**：日誌可能包含敏感資訊
4. **備份重要日誌**：及時備份有價值的日誌檔案

## 📞 支援

如有問題，請檢查：
1. 設備連接是否穩定
2. ADB 工具是否正常工作
3. APK 檔案是否完整
4. 系統權限是否足夠

## 🔄 更新日誌

- **v1.0**：初始版本，支援基本安裝和日誌記錄
- **v1.1**：新增 PowerShell 版本，無需 Python
- **v1.2**：改進錯誤處理和用戶體驗
